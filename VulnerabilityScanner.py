import requests
from bs4 import BeautifulSoup

def scan_sql_injection(url):
    payloads = ["' OR '1'='1", "' OR '1'='1' --", '" OR "1"="1', '" OR "1"="1" --']
    results = []

    for payload in payloads:
        try:
            response = requests.get(f"{url}{payload}")
            if payload in response.text:
                results.append(f"SQL Injection Vulnerability found with payload: {payload}")
        except requests.RequestException as e:
            print(f"Error: {str(e)}")

    return results

def scan_xss(url):
    payloads = ["<script>alert('XSS')</script>", "<img src='x' onerror='alert(\"XSS\")'>"]
    results = []

    for payload in payloads:
        try:
            response = requests.get(f"{url}?input={payload}")
            soup = BeautifulSoup(response.text, 'html.parser')
            if payload in soup.text:
                results.append(f"XSS Vulnerability found with payload: {payload}")
        except requests.RequestException as e:
            print(f"Error: {str(e)}")

    return results

if __name__ == "__main__":
    target_url = input("Enter the target URL: ")

    try:
        sql_injection_results = scan_sql_injection(target_url)
        xss_results = scan_xss(target_url)

        print("\nResults:")
        if sql_injection_results:
            print("\nSQL Injection Vulnerabilities:")
            for result in sql_injection_results:
                print(result)

        if xss_results:
            print("\nXSS Vulnerabilities:")
            for result in xss_results:
                print(result)
    except Exception as e:
        print(f"An error occurred: {str(e)}")